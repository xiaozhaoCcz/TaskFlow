# 画布组件拖拽功能使用指南

## 快速开始

### 1. 启动项目
```bash
npm install
npm run dev
```

然后在浏览器中打开 http://localhost:5173

## 功能演示

### 场景一：创建新任务
**从左侧面板拖拽到画布**

1. 在左侧找到你需要的任务类型（如"打开网页"、"点击元素"等）
2. 按住鼠标左键拖拽任务
3. 拖到右侧画布空白区域
4. 释放鼠标，新任务创建完成

### 场景二：移动现有任务
**在画布内拖拽重新排列**

1. 在画布中找到要移动的任务
2. 将鼠标悬停在任务的标题栏上（整个任务块）
3. 按住鼠标左键开始拖拽
4. 任务会变为半透明状态
5. 拖到目标位置后释放
6. 任务会从原位置消失，出现在新位置

### 场景三：拖入 IF 条件分支
**将任务拖入条件判断**

1. 首先在画布中添加一个 "IF条件" 任务
2. 点击 IF 任务展开它（如果未展开）
3. 你会看到两个区域：
   - ✓ THEN (条件为真)
   - ✗ ELSE (条件为假)
4. 将任务拖到相应的区域
5. 当看到蓝色虚线边框时释放鼠标
6. 任务会出现在该分支内

**示例：**
```
IF (count > 5)
  THEN:
    → 打开网页      ← 拖拽到这里
    → 点击按钮      ← 拖拽到这里
  ELSE:
    → 等待          ← 拖拽到这里
```

### 场景四：拖入循环体
**将任务拖入 While 或 Foreach 循环**

1. 添加 "While循环" 或 "Foreach遍历" 任务
2. 展开循环任务
3. 你会看到 "🔄 循环体" 区域
4. 将需要重复执行的任务拖入这个区域
5. 释放鼠标完成添加

**示例：**
```
While (count < 10)
  循环体:
    → 点击按钮      ← 拖拽到这里
    → 等待 1秒      ← 拖拽到这里
    → 截图          ← 拖拽到这里
```

### 场景五：拖入异常处理
**将任务拖入 Try-Catch 块**

1. 添加 "Try异常捕获" 任务
2. 展开它，会看到两个区域：
   - 🛡️ TRY（尝试执行）
   - ⚠️ CATCH（异常处理）
3. 将可能出错的任务拖入 TRY 区域
4. 将错误处理任务拖入 CATCH 区域

**示例：**
```
Try
  TRY:
    → 点击元素      ← 可能找不到元素
    → 输入文本      ← 可能输入失败
  CATCH:
    → 截图          ← 出错时执行
    → 等待 2秒      ← 出错时执行
```

### 场景六：从嵌套拖到顶层
**将嵌套的任务拖出容器**

1. 展开容器任务（IF/While/Try等）
2. 找到要移出的嵌套任务
3. 拖拽该任务到画布的空白区域
4. 释放鼠标，任务会移到顶层

## 视觉提示

### 拖拽状态
- **正在拖拽**：源任务显示为半透明（opacity: 0.4）
- **可放置区域悬停**：目标区域显示蓝色虚线边框
- **鼠标图标**：
  - 从面板拖拽 → "复制"图标
  - 画布内拖拽 → "移动"图标

### 容器状态
- **空容器**：显示 "拖拽任务到这里" 提示
- **有任务的容器**：直接显示任务列表

## 实用技巧

### 技巧 1：快速重排序
不需要使用上下箭头按钮，直接拖拽即可重新排列任务顺序。

### 技巧 2：跨层级移动
可以直接将深层嵌套的任务拖到顶层，无需多步操作。

### 技巧 3：批量组织
先在顶层创建多个任务，然后再拖入相应的容器中组织结构。

### 技巧 4：可视化调试
拖拽功能使得工作流结构调整更加直观，方便调试和优化。

## 兼容旧功能

原有的功能完全保留：

- ✅ **上下移动按钮**：仍然可以使用 ↑ ↓ 按钮进行微调
- ✅ **删除按钮**：点击 × 删除任务
- ✅ **展开/收起**：点击 ▶/▼ 展开或收起容器
- ✅ **配置编辑**：展开任务后可以编辑配置

## 常见问题

**Q: 为什么拖拽后原任务消失了？**
A: 这是正常行为。画布内拖拽是"移动"操作，不是"复制"。如果需要复制，请从左侧面板重新拖一个。

**Q: 如何取消正在进行的拖拽？**
A: 按 ESC 键或将任务拖到画布外释放即可取消。

**Q: 可以拖拽到自己的内部吗？**
A: 不建议这样做，可能会导致循环引用。未来版本会添加此限制。

**Q: 拖拽时任务配置会丢失吗？**
A: 不会。移动任务时会保留所有配置信息。

**Q: 可以拖拽多个任务吗？**
A: 当前版本不支持多选拖拽，请逐个拖拽。

## 下一步

- 浏览 [DRAG_DROP_FEATURE.md](./DRAG_DROP_FEATURE.md) 了解技术实现细节
- 查看 [README.md](./README.md) 了解项目整体信息
- 尝试构建一个复杂的工作流来熟悉拖拽功能

## 反馈

如果发现任何问题或有改进建议，欢迎提交 Issue。
